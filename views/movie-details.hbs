<!DOCTYPE html>
<html>
<head>
  <title>{{movie.title}} [{{formatRating movie.vote_average}}]</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <div class="container movie-detail-container">
    <!-- Movie Title -->
    <h1>{{movie.title}} [{{formatRating movie.vote_average}}]</h1>

    <div class="movie-detail-flex">
      <!-- Poster Image -->
      <div class="movie-detail-poster">
        <img src="https://image.tmdb.org/t/p/w300{{movie.poster_path}}" alt="{{movie.title}}">
      </div>

      <!-- Movie Info -->
      <div class="movie-detail-info">
        <h2>Brief Description:</h2>
        <p>{{movie.overview}}</p>

        {{#if @root.session.user}}
          {{#if alreadyAdded}}
            <button class="disabled-btn" disabled>Already Added</button>
          {{else}}
            <form action="/add" method="POST">
              <input type="hidden" name="id" value="{{movie.id}}">
              <input type="hidden" name="title" value="{{movie.title}}">
              <input type="hidden" name="poster" value="{{movie.poster_path}}">
              <input type="hidden" name="overview" value="{{movie.overview}}">
              <button type="submit">Add to Watchlist</button>
            </form>
          {{/if}}
        {{else}}
          <a href="/login?redirect=/add-after-login&movieId={{movie.id}}&title={{encode movie.title}}&poster={{encode movie.poster_path}}&overview={{encode movie.overview}}">Sign in to add to your watchlist</a>
        {{/if}}
      </div>
    </div>
  </div>

  <!-- TMDb Attribution Logo -->
  <div class="tmdb-logo-container">
    <a href="https://www.themoviedb.org/" target="_blank" rel="noopener">
      <img src="/images/tmdb-logo.svg" alt="TMDb Logo" class="tmdb-logo">
    </a>
    <p class="tmdb-caption">
      This application uses the TMDb API but is not endorsed or certified by TMDb.
    </p>
  </div>
</body>
</html>
